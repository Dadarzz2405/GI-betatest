{% extends "base.html" %}

{% block title %}Member Dashboard â€” Rohis{% endblock %}

{% block head %}

<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/main.min.css" rel="stylesheet">

<style>
#dashboard-calendar {
    margin-top: 30px;
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
.fc-event-title {
    display: flex;
    align-items: center;
}
.islamic-icon {
    margin-right: 6px;
}
</style>

{% endblock %}

{% block content %}

<div class="mt-4">
    <div class="card shadow p-4">

```
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h2 class="fw-bold mb-0">Member Dashboard</h2>
            <p class="text-muted mb-0">
                Welcome, {{ current_user.username }}
            </p>
        </div>
    </div>

    <hr>

    <div class="row g-3">
        <div class="col-md-6">
            <a href="/attendance-history"
               class="card text-decoration-none text-dark h-100 shadow-sm p-3 d-block">
                <h5 class="mb-1">ðŸ“ˆ My Attendance History</h5>
                <p class="small text-muted mb-0">
                    View your attendance per session
                </p>
            </a>
        </div>

        <div class="col-md-6">
            <a href="/member-list"
               class="card text-decoration-none text-dark h-100 shadow-sm p-3 d-block">
                <h5 class="mb-1">ðŸ‘¥ View Member List</h5>
                <p class="small text-muted mb-0">
                    See other members
                </p>
            </a>
        </div>
    </div>

    <hr class="my-5">

    <h3>Rohis Calendar</h3>
    <p class="text-muted">
        Shows Gregorian & Hijri dates. Islamic holidays are highlighted ðŸŒ™
    </p>

    <div id="dashboard-calendar"></div>

</div>
```

</div>
{% endblock %}

{% block scripts %}
{{ super() }}

<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const calendarEl = document.getElementById('dashboard-calendar');

    const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        events: '/api/dashboard_calendar',
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        eventContent: function (arg) {
            const isHoliday = arg.event.extendedProps.type === 'islamic_holiday';
            const el = document.createElement('div');
            el.classList.add('fc-event-title');

            el.innerHTML = isHoliday
                ? `<span class="islamic-icon">ðŸŒ™</span>${arg.event.title}`
                : arg.event.title;

            return { domNodes: [el] };
        },
        height: 650
    });

    calendar.render();
});
</script>

{% endblock %}
